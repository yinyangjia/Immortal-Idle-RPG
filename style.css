/* ==========================================================================
   1. 核心变量与重置 (Variables & Reset)
   ========================================================================== */
:root {
    /* --- 配色方案 --- */
    --bg-color: #121212;        /* 网页背景 */
    --panel-bg: #1e1e1e;        /* 主面板背景 */
    --card-bg: #262626;         /* 卡片背景 */
    --text-main: #e0e0e0;       /* 主文字 */
    --text-dim: #9e9e9e;        /* 次要文字 */
    
    /* --- 功能色 --- */
    --accent-gold: #ffd700;     /* 灵石/传说/高亮 */
    --rare-blue: #40c4ff;       /* 道韵/名望/技能 */
    --magic-purple: #d500f9;    /* 魔晶/特殊 */
    --danger-red: #ff5252;      /* 敌人/血条/售出 */
    --success-green: #00e676;   /* 治疗/购买/增益 */
    
    /* --- 布局参数 --- */
    --border-c: #444;           /* 通用边框色 */
    --radius-s: 4px;
    --radius-m: 8px;
    --radius-l: 12px;
}

* { box-sizing: border-box; }

body {
    background-color: var(--bg-color);
    color: var(--text-main);
    font-family: 'Segoe UI', Roboto, 'PingFang SC', sans-serif;
    margin: 0; padding: 10px;
    display: flex; justify-content: center;
    user-select: none; /* 禁止选中文本 */
    -webkit-tap-highlight-color: transparent;
}

/* ==========================================================================
   2. 主容器 (Main Container)
   ========================================================================== */
#game-container {
    width: 100%; 
    max-width: 500px; /* 电脑端限制宽度 */
    background: var(--panel-bg);
    border: 1px solid #333;
    border-radius: var(--radius-l);
    padding: 15px;
    box-shadow: 0 0 40px rgba(0,0,0,0.8);
    display: flex; 
    flex-direction: column; 
    gap: 12px;
    position: relative;
}

/* 通用按钮样式 */
button {
    cursor: pointer;
    border-radius: var(--radius-s);
    border: 1px solid var(--border-c);
    background: #333;
    color: #fff;
    font-family: inherit;
    transition: all 0.1s ease;
}
button:active { transform: scale(0.96); opacity: 0.9; }
button:disabled { opacity: 0.5; cursor: not-allowed; }

/* ==========================================================================
   3. 顶部栏与属性面板 (Header & Stats)
   ========================================================================== */
#top-bar {
    display: flex; justify-content: space-between; align-items: center;
    background: #252525; padding: 8px 12px; border-radius: var(--radius-m);
    border-bottom: 2px solid #333;
}
#top-bar button { padding: 6px 12px; font-size: 0.85em; }

.currency { font-size: 0.85em; color: #fff; }
.currency span { font-weight: bold; margin-right: 5px; }

header h1 {
    margin: 5px 0; text-align: center;
    font-size: 1.3em; color: var(--accent-gold);
    letter-spacing: 2px; text-shadow: 0 0 5px rgba(255,215,0,0.2);
}

.stats-grid {
    display: grid; grid-template-columns: 1fr 1fr; gap: 8px;
    background: #252525; padding: 10px; border-radius: var(--radius-m);
    font-size: 0.9em;
}
.full-width {
    grid-column: span 2; text-align: center;
    margin-top: 4px; padding-top: 6px;
    border-top: 1px solid var(--border-c);
    color: var(--accent-gold); font-size: 0.9em;
}

#btn-breakthrough {
    width: 100%; padding: 10px;
    background: linear-gradient(135deg, #ffb300, #ff6f00);
    color: #000; border: none; font-weight: bold; font-size: 1em;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3);
}

/* ==========================================================================
   4. 战斗日志 (Log System)
   ========================================================================== */
#log-container {
    height: 150px; 
    background: #080808;
    border: 1px solid var(--border-c);
    padding: 8px;
    overflow-y: auto;
    font-family: 'Consolas', monospace; font-size: 0.85em;
    border-radius: var(--radius-s);
    display: flex; flex-direction: column-reverse; /* 最新消息在最上 */
}

/* 滚动条美化 */
#log-container::-webkit-scrollbar { width: 4px; }
#log-container::-webkit-scrollbar-thumb { background: #444; border-radius: 2px; }

.log-entry { margin-bottom: 3px; border-bottom: 1px dashed #222; padding-bottom: 2px; line-height: 1.4; }
.log-win { color: var(--success-green); }
.log-lose { color: var(--danger-red); }
.log-skill { color: var(--rare-blue); font-weight: bold; }
.log-system { color: var(--text-dim); font-style: italic; }

/* ==========================================================================
   5. 地图与战斗面板 (Map & Combat)
   ========================================================================== */
#map-controls { display: flex; flex-wrap: wrap; gap: 6px; }
.map-btn {
    flex: 1 1 30%; padding: 10px; font-size: 0.9em;
    background: #2b2b2b; color: #888;
}
.map-btn.active {
    background: var(--accent-gold); color: #000;
    font-weight: bold; border-color: #fff;
    box-shadow: 0 0 8px rgba(255,215,0,0.3);
}

#enemy-panel {
    background: #252525; padding: 12px; border-radius: var(--radius-m);
    text-align: center; border: 1px solid #333;
}
#enemy-name { font-weight: bold; font-size: 1.1em; margin-right: 5px; }

/* 血条容器 */
.hp-bar {
    height: 12px; /* 强制高度 */
    background: #111; margin-top: 8px;
    border: 1px solid #555; border-radius: 6px;
    overflow: hidden; position: relative;
}
/* 动态血条 */
#enemy-hp-bar {
    height: 100%; width: 100%;
    background: var(--danger-red);
    transition: width 0.1s linear; /* 线性过渡更适合高频刷新 */
}

/* ==========================================================================
   6. 弹窗与全屏面板 (Modals)
   ========================================================================== */
.modal {
    position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
    width: 92%; max-width: 550px;
    background: #181818;
    border: 2px solid var(--accent-gold);
    padding: 15px;
    z-index: 1000;
    border-radius: var(--radius-l);
    color: #fff;
    box-shadow: 0 0 100px rgba(0,0,0,0.9);
    display: flex; flex-direction: column;
}
.hidden { display: none !important; }
.full-screen { height: 88vh; }

.panel-header {
    display: flex; justify-content: space-between; align-items: center;
    padding-bottom: 10px; border-bottom: 1px solid var(--border-c); margin-bottom: 10px;
}
.panel-header h2 { margin: 0; font-size: 1.2em; color: var(--accent-gold); }

.panel-content {
    display: flex; flex: 1; gap: 15px; overflow: hidden;
}

/* ==========================================================================
   7. 角色与背包布局 (Character & Inventory)
   ========================================================================== */
/* 左侧：装备区 */
.equip-section {
    flex: 1; display: flex; flex-direction: column; gap: 6px;
    overflow-y: auto; border-right: 1px solid var(--border-c); padding-right: 10px;
    min-width: 130px;
}

.slot {
    background: #222; border: 1px solid var(--border-c); padding: 8px;
    text-align: center; font-size: 0.85em; cursor: pointer; color: #666;
    border-radius: 4px;
}
.slot.equipped {
    border-color: var(--rare-blue); color: var(--rare-blue);
    background: rgba(64, 196, 255, 0.05);
}

/* 右侧：背包区 */
.bag-section { flex: 2; display: flex; flex-direction: column; overflow: hidden; }

/* 网格系统 */
#inventory-grid, #shop-list, #monster-list, .grid-list {
    display: grid; 
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 8px; 
    overflow-y: auto; padding: 5px; flex: 1;
    min-height: 200px; /* 防止高度塌陷 */
    align-content: start; /* 内容置顶 */
}
#monster-list { grid-template-columns: 1fr; } /* 怪物单列 */

/* ==========================================================================
   8. 物品卡片 (Item Cards) - 核心UI组件
   ========================================================================== */
.item-card, .monster-card {
    background: var(--card-bg);
    border: 1px solid var(--border-c);
    padding: 8px;
    border-radius: var(--radius-s);
    font-size: 0.85em; text-align: center;
    display: flex; flex-direction: column; justify-content: space-between;
    min-height: 110px; /* 强制卡片高度 */
    color: #fff;       /* 强制文字颜色 */
    position: relative;
    transition: transform 0.1s;
}
.item-card:hover { transform: translateY(-2px); border-color: #666; }

.monster-card { flex-direction: row; min-height: auto; text-align: left; padding: 12px; }
.monster-card:hover { border-color: var(--accent-gold); background: #333; }

/* 装备品质边框 */
.tier-1 { border-top: 3px solid #fff; }
.tier-2 { border-top: 3px solid var(--success-green); }
.tier-3 { border-top: 3px solid var(--rare-blue); }
.tier-4 { border-top: 3px solid var(--epic-purple); }
.tier-5 { border-top: 3px solid var(--legend-orange); }
.tier-10 { border-top: 3px solid var(--danger-red); box-shadow: 0 0 10px var(--danger-red); }

/* --- 特殊物品样式 --- */
/* 魔晶：紫色流光边框 */
.item-card.type-crystal {
    border: 1px solid var(--magic-purple);
    box-shadow: inset 0 0 8px rgba(213, 0, 249, 0.15);
}
/* 掉落券：金色边框 */
.item-card.type-coupon {
    border: 1px solid var(--accent-gold);
}

/* ==========================================================================
   9. 交互元素 (Buttons & Tags)
   ========================================================================== */
.btn-group { display: flex; gap: 4px; margin-top: 6px; }

.item-btn {
    flex: 1; border: none; padding: 4px;
    color: white; background: #3e3e3e;
    border-radius: 3px; font-size: 0.9em;
}
.item-btn:hover { background: #555; }

/* 特定功能按钮 */
.btn-sell { background: #3e2723; color: #ffccbc; }
.btn-sell:hover { background: #d32f2f; color: white; }

.btn-buy { background: #1b5e20; width: 100%; margin-top: 5px; }
.btn-buy:hover { background: #2e7d32; }

/* 技能标签 */
.skill-tag {
    display: inline-block;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid #555;
    color: #aaa;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.85em;
    margin: 2px;
    cursor: pointer;
    transition: all 0.2s;
}

/* 激活的技能 (绿色高亮) */
.skill-tag.active {
    background: rgba(0, 230, 118, 0.15);
    border-color: var(--success-green);
    color: var(--success-green);
    font-weight: bold;
    box-shadow: 0 0 5px rgba(0, 230, 118, 0.3);
}

/* ==========================================================================
   10. 移动端适配 (Mobile Responsive)
   ========================================================================== */
@media (max-width: 600px) {
    .full-screen { height: 95vh; width: 95% !important; }
    
    .panel-content {
        flex-direction: column; /* 垂直排列 */
        overflow-y: auto;
    }
    
    .equip-section {
        flex: none; /* 取消自动伸缩 */
        display: grid;
        grid-template-columns: 1fr 1fr 1fr; /* 三列显示装备 */
        border-right: none;
        border-bottom: 1px solid var(--border-c);
        padding-bottom: 10px;
        padding-right: 0;
        max-height: none; /* 让它自然撑开 */
    }
    
    .bag-section { flex: 1; }
    
    /* 缩小网格以适应窄屏 */
    #inventory-grid { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); }
}
